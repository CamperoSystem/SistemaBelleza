@{
    Layout = "~/Views/Shared/LayoutAdmin.cshtml";
    ViewBag.Title = "Reportes del Sistema";
    var tipo = ViewBag.Tipo as string;
}

<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

<h2 class="text-center my-4 text-primary">
    <i class="bi bi-bar-chart-fill"></i> Reportes del Sistema
</h2>

@using (Html.BeginForm("Filtrar", "Reportes", FormMethod.Post))
{
    <div class="row mb-4">
        <div class="col-md-6">
            <label class="form-label">Tipo de reporte:</label>
            <select name="tipo" class="form-select" required>
                <option value="">Seleccione un tipo</option>
                <option value="productos" @(tipo == "productos" ? "selected" : "")>Productos</option>
                <option value="usuarios" @(tipo == "usuarios" ? "selected" : "")>Usuarios</option>
                <option value="ordenes" @(tipo == "ordenes" ? "selected" : "")>Órdenes</option>
                <option value="marcas" @(tipo == "marcas" ? "selected" : "")>Marcas</option>
            </select>
        </div>
        <div class="col-md-6 d-flex align-items-end">
            <button type="submit" class="btn btn-primary w-100">
                <i class="bi bi-search"></i> Ver Reporte
            </button>
        </div>
    </div>
}

@if (!string.IsNullOrEmpty(ViewBag.TituloReporte))
{
    <h4 class="text-success text-center">@ViewBag.TituloReporte</h4>
}

@if (Model != null)
{
    if (tipo == "productos")
    {
        var data = Model as IEnumerable<SistemaBelleza.Models.producto>;
        <table class="table table-bordered table-hover align-middle shadow-sm mt-3">
            <thead class="table-primary text-center">
                <tr>
                    <th>ID</th>
                    <th>Nombre</th>
                    <th>Precio</th>
                    <th>Stock</th>
                    <th>Género</th>
                    <th>Tipo</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var p in data)
                {
                    <tr>
                        <td>@p.id_producto</td>
                        <td>@p.nombre</td>
                        <td>@p.precio Bs</td>
                        <td>@p.stock</td>
                        <td>@p.genero</td>
                        <td>@p.tipo_producto</td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else if (tipo == "usuarios")
    {
        var data = Model as IEnumerable<SistemaBelleza.Models.usuario>;
        <table class="table table-bordered table-hover align-middle shadow-sm mt-3">
            <thead class="table-primary text-center">
                <tr>
                    <th>ID</th>
                    <th>Nombre</th>
                    <th>Correo</th>
                    <th>Teléfono</th>
                    <th>Rol</th>
                    <th>Fecha Registro</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var u in data)
                {
                    <tr>
                        <td>@u.id_usuario</td>
                        <td>@u.nombre</td>
                        <td>@u.correo</td>
                        <td>@u.telefono</td>
                        <td>@u.rol</td>
                        <td>@(u.fecha_registro?.ToString("yyyy-MM-dd") ?? "")</td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else if (tipo == "ordenes")
    {
        var data = Model as IEnumerable<SistemaBelleza.Models.ordene>;
        <table class="table table-bordered table-hover align-middle shadow-sm mt-3">
            <thead class="table-primary text-center">
                <tr>
                    <th>ID</th>
                    <th>ID Usuario</th>
                    <th>Total</th>
                    <th>Pago</th>
                    <th>Envío</th>
                    <th>Método</th>
                    <th>Fecha</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var o in data)
                {
                    <tr>
                        <td>@o.id_orden</td>
                        <td>@o.id_usuario</td>
                        <td>@o.total Bs</td>
                        <td>@o.estado_pago</td>
                        <td>@o.estado_envio</td>
                        <td>@o.metodo_pago</td>
                        <td>@(o.fecha?.ToString("yyyy-MM-dd") ?? "")</td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else if (tipo == "marcas")
    {
        var data = Model as IEnumerable<SistemaBelleza.Models.marca>;
        <table class="table table-bordered table-hover align-middle shadow-sm mt-3">
            <thead class="table-primary text-center">
                <tr>
                    <th>ID</th>
                    <th>Nombre</th>
                    <th>Descripción</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var m in data)
                {
                    <tr>
                        <td>@m.id_marca</td>
                        <td>@m.nombre</td>
                        <td>@m.descripcion</td>
                    </tr>
                }
            </tbody>
        </table>
    }
}
else if (ViewBag.Mensaje != null)
{
    <div class="alert alert-info text-center">@ViewBag.Mensaje</div>
}
